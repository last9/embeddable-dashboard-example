<!-- Add required dependencies -->
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

<!-- Container for your app -->
<div id="embedded-app-container"></div>

<!-- Add your embedded app script -->
<script src="/dist/embedded-app.umd.js"></script>

<script>
  // Initialize the embedded app
  EmbeddedApp.initialize({
    containerId: 'embedded-app-container',
    org: 'last9',
    baseUrl: 'https://alpha.last9.io',
    getToken: async () => {
      const apiUrl = 'http://localhost:8080/embed-token';
      const data = {
        datasource_id: '0284dd90-7b00-49b0-8cd0-b3779cbe416d',
        dashboard_id: 'caefc113-b913-4f3a-a759-aae6f72ccaef',
        variables: {
          service: ['preprod-tr-rtt-service-tomcat-svc'],
          latency: [0.5],
        },
      };

      const requestOptions = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data),
      };

      console.info('Fetching token from server...');
      const response = await fetch(apiUrl, requestOptions);

      if (!response.ok) {
        console.error('Error:', error);
        throw new Error('Error occurred while fetching access token.');
      }

      console.info('Token fetched successfully!');
      return response.json();
    },
  });
</script>
